## 例子：金融
##### 总体原则：先“工程化”到极致，再考虑微调

在金融（合规、可控、稳定）场景里，很多问题优先用这些手段解决，性价比往往高于微调：

- 高质量 Prompt 模板 + 约束解码（JSON schema / grammar / regex / tool schema）
- RAG / 规则 / 词典 / 知识库（尤其是产品条款、费率、交易规则、流程制度）
- 后处理与校验（字段校验、数值范围、枚举白名单、置信度门控）
- 路由与多模型组合（便宜模型做粗分流+检索，大模型做复杂推理；或小模型做结构化抽取，大模型做生成）

微调真正“划算”的前提通常是：`需求长期稳定 + 数据可规模化 + 指标可测 + 线上收益显著`（准确率/一致性/成本/延迟）。

### 1 Query 改写（检索改写、扩展、去歧义、纠错）
#### 1.1 通用大模型可直接用的情况

- 改写目标主要是检索：比如把“我想查下信用卡分期手续费”改写成更适合向量检索/关键词检索的 query。

- 容错成本低：改写不完美也不会直接造成业务错误，最多是召回少一点。

- 你能做“多路召回”兜底：原 query + 改写 query + 关键词抽取并行检索。

#### 1.2 建议微调/定制的情况

- 金融专有名词密集且歧义高：如“融券/融资”“两融担保品折算率”“净值/份额/单位净值”等，通用模型容易改写错方向。

- 你需要强一致的“检索意图保真”：不能把“提前还款违约金”改写成“利息计算方式”这种偏移。

- 改写需要绑定内部产品体系：例如把“X宝”稳定映射到你行内的某产品编码/渠道名称（这更像“标准化映射”任务）。

实操建议：很多团队会选择 不微调大模型，而是用 轻量小模型/规则 做“术语归一+产品映射”，再让通用大模型做自然语言层面的改写。

### 2 槽位抽取 / 实体识别（Slot Filling / NER）

这里是金融里最容易“值得微调”的环节之一，因为它强结构化、可评估、且对一致性要求高。

#### 2.1 通用大模型可直接用的情况

- 槽位少、枚举明确、可以强约束输出（JSON schema）。

- 你能接受偶发不稳定，并且有 校验+追问：例如缺字段就追问；字段越界就拒绝。

- 数据分布很宽、场景变化快，先快速上线验证。

#### 2.2 有必要微调的情况（高收益）

- 槽位体系稳定且重要：如（业务类型、产品、渠道、客户类型、地区、时间范围、金额区间、风险偏好、交易方向…）。

- 对一致性/召回要求很高：比如工单分派、反欺诈线索结构化、合规审计标签。

- 需要更强的“长尾覆盖”：方言、口语、省略表达、内部简称。

- 线上成本敏感：用微调后的中小模型替代大模型做抽取，成本/延迟可显著下降。

结论：槽位抽取=微调高性价比区（尤其用中小模型 LoRA/QLoRA）。

### 3 意图识别 / 路由（Intent Classification / Router）
#### 3.1 通用大模型可直接用的情况

- 意图集合较少（<30）且边界清晰。

- 你愿意做 “LLM + 规则” 的混合：高风险意图（交易、转账、征信、投顾）走更严格链路。

- 允许“低置信度就转人工/澄清”。

#### 3.2 建议微调的情况

- 意图集合多且相互相似（如几十到上百个业务意图，且文本很短）。

- 必须非常稳定：路由错一次就可能触发错误工具/错误流程（交易类尤其危险）。

- 你要做层级意图 + 多标签（例如：咨询/投诉/交易/风控/合规 + 产品线 + 渠道 + 阶段）。

很多金融机构会做：
微调小模型做意图/多标签（稳定、便宜、可测） + 大模型做解释/追问/生成。

### 4 Function Calling / Tool Use（Agent 调工具，MCP 调服务）
#### 4.1 通用大模型可直接用的情况

- 工具数量不多、参数简单，且你能做强校验（schema + 白名单）。

- 有 安全执行层：模型只“提议调用”，最终由规则/策略引擎批准（比如金额上限、敏感操作二次确认）。

- 允许失败重试、允许“问清楚再调用”。

#### 4.2 有必要微调的情况

- 工具很多（上百），且工具高度相似（同名不同域、参数细微差别）。

- 你希望降低“幻觉调用/错参/漏参”，并减少对 prompt 堆料依赖。

- 你有大量历史“正确调用轨迹”（对话 → tool → 参数 → 返回 → 下一步）可以监督学习。

- 延迟/成本要求很苛刻：希望用微调模型在工具选择上“一步到位”。

但要提醒：工具调用的可靠性，很多时候靠的是
(1) 工具设计（清晰命名、参数少、互斥明显）+(2) 约束解码+(3) 执行层校验，微调是锦上添花，不是唯一解。

### 5 自我认知 / 边界意识（合规拒答、能力边界、风险提示）

（你说的“自我认知”我理解为：模型知道自己在金融场景里能做什么/不能做什么，何时拒答、何时提示风险、何时转人工。）

#### 5.1 通用大模型可直接用的情况

- 通过 系统提示词+政策规则+敏感词/分类器 就能把高风险内容挡住。

- 你采用 策略引擎：对投顾、交易、征信、KYC、反洗钱等敏感请求进行流程化控制，而不是靠模型“自觉”。

#### 5.2 可能需要微调的情况

- 你希望“拒答/转人工/风险提示”的风格和触发条件非常统一，且与本机构话术一致。

- 你需要模型在复杂对话中稳定识别“隐性高风险需求”（例如用户绕着问投顾建议、诱导合规边界）。

- 你要减少“过度拒绝”与“漏拒绝”的波动，并能在指标上持续优化。

经验上：合规边界更适合“分类器/规则/策略层”做硬约束；微调更多解决“表达一致性”和“复杂语境下的判别”。

### 6 生成内容（客服话术、产品解释、投教、摘要、报告草稿）
#### 6.1 通用大模型可直接用的情况

- 内容以“已有材料”为准：RAG 拉取条款/公告/FAQ，然后生成“可读版”解释。

- 有明确的 引用/依据（必须标注来源段落或文档ID），并做事实校验。

- 输出风格不需要完全一致，允许少量个性化。

#### 6.2 建议微调的情况

- 你要高度统一的品牌话术、语气、结构（尤其全渠道一致：APP、客服、短信、邮件）。

- 你要稳定生成特定模板：如“风险揭示书摘要”“录音质检点评”“工单结论+处置建议”的固定段落结构。

- RAG 已经做了，但你仍然遇到：

    - “说法不合规/不完整”（缺少必备免责声明）
    - “关键点漏写/顺序乱”
    - “同类问题输出漂移很大”

- 你希望用更小的本地模型稳定输出，降低成本并满足数据不出域。

金融生成内容通常不追求“更会写”，而追求“可控、可审计、可复现”。微调常常是为了“模板一致性 + 合规要素齐全”。

### 7 一个快速决策表（你可以拿去做评审）

>更适合通用大模型（API/本地）

- 场景变化快、需求尚不稳定
- 可容错、有兜底（检索多路召回、追问、人工）
- 结果可被校验/约束（schema、枚举、范围）
- 主要难点在推理与表达，而非固定标签

>更值得微调（优先级从高到低常见是：抽取/意图/工具路由/话术一致性）

- 目标明确可量化（F1/准确率/一致性/拒答命中率/工具成功率）
- 数据量足且质量高（最好有“正确答案/轨迹”）
- 业务与术语高度内生（内部产品体系、流程、简称）
- 必须稳定一致（监管/审计/质检/规模化运营）
- 成本与延迟压力大（希望用小模型替代大模型）

### 推荐的落地路线（最稳妥的一种）

- 先用通用大模型 + RAG + 强约束输出把链路跑通

- 把线上日志沉淀成数据：意图标签、槽位真值、tool 调用轨迹、拒答/转人工原因、用户纠错反馈

- 选“ROI最高”的点微调（通常是：意图识别/槽位抽取）
- 生成类如果要微调，优先做：模板化生成 + 合规要素补全（而不是让模型自由发挥）